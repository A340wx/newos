STDINCLUDE := -Iinclude -Iinclude/libc -Iinclude/libc++ $(LIBGCC_INCLUDE)
GLOBAL_CFLAGS := $(GLOBAL_CFLAGS) -include include/newos/sysconfig.h

LIBS_DIR := lib
LIBS_BUILD_DIR := $(call TOBUILDDIR, lib)
LIBS := $(addprefix $(LIBS_BUILD_DIR)/, \
	glue/glue.o \
	glue/libglue.o \
	libc/libc.so \
	libc/libc.a \
	libm/libm.so \
	libm/libm.a \
	libnewos/libnewos.so \
	libnewos/libnewos.a \
	libsocket/libsocket.so \
	libsocket/libsocket.a \
	libsupc++/libsupc++.so \
	libsupc++/libsupc++.a \
	libwin/libwin.so \
	libwin/libwin.a \
	klibc/klibc.o \
)	
LIBGLUE := $(LIBS_BUILD_DIR)/glue/libglue.o
LIBS_LDSCRIPT := $(LIBS_DIR)/ldscripts/$(ARCH)/library.ld
LIBC := $(LIBS_BUILD_DIR)/libc/libc.so
LIBC_STATIC := $(LIBS_BUILD_DIR)/libc/libc.a
LIBNEWOS_STATIC := $(LIBS_BUILD_DIR)/libnewos/libnewos.a
#$(warning LIBS = $(LIBS))

KERNEL_DIR := kernel
KERNEL_BUILD_DIR := $(call TOBUILDDIR, kernel)
KERNEL := $(KERNEL_BUILD_DIR)/kernel
LIBKERNEL := $(KERNEL_BUILD_DIR)/kernel.so
KLIBS := $(LIBS_BUILD_DIR)/klibc/klibc.o
KERNEL_CFLAGS := $(KERNEL_CFLAGS) -D_KERNEL=1
#$(warning KERNEL = $(KERNEL))

KERNEL_ADDONS_DIR := kernel/addons
KERNEL_ADDONS_BUILD_DIR := $(KERNEL_BUILD_DIR)/addons
KERNEL_ADDONS := $(addprefix $(KERNEL_ADDONS_BUILD_DIR)/, \
	fs/iso9660/iso9660 \
	fs/nfs/nfs \
	fs/zfs/zfs \
	dev/tty/tty \
	dev/console/console \
)

APPS_DIR := apps
APPS_BUILD_DIR := $(call TOBUILDDIR, apps)
APPS_LDSCRIPT = $(APPS_DIR)/ldscripts/$(ARCH)/app.ld
APPSGLUE := $(LIBS_BUILD_DIR)/glue/glue.o
APPS := $(addprefix $(APPS_BUILD_DIR)/, \
	cpptest/cpptest \
	false/false \
	fibo/fibo \
	fortune/fortune \
	init/init \
	ls/ls \
	mount/mount \
	rld/rld.so \
	rldtest/rldtest \
	shell/shell \
	test_output/test_output \
	test_input/test_input \
	testapp/testapp \
	true/true \
	unmount/unmount \
	vmtest/vmtest \
	vtcolors/vtcolors \
	rm/rm\
	ps/ps \
	top/top \
	netcfg/netcfg \
	nettest/nettest \
	irc/irc \
	consoled/consoled \
	socketd/socketd \
	telnetd/telnetd \
	inputd/inputd \
	window_server/window_server \
	guiapp/guiapp \
	disktest/disktest \
)
ULIBS := \
	$(LIBS_BUILD_DIR)/libc/libc.so \
	$(LIBS_BUILD_DIR)/libm/libm.so \
	$(LIBS_BUILD_DIR)/libnewos/libnewos.so \
	$(LIBS_BUILD_DIR)/libsocket/libsocket.so \
	$(LIBS_BUILD_DIR)/libsupc++/libsupc++.so \
	$(LIBS_BUILD_DIR)/libwin/libwin.so

ULIB_PATHS :=
#$(warning APPS = $(APPS))

STATICFILES_DIR := $(call TOBUILDDIR, static)
STATICFILES := $(addprefix $(STATICFILES_DIR)/, \
)

FINAL := $(call TOBUILDDIR, final)
#$(warning FINAL = $(FINAL))

include make.config.$(ARCH)

ALL := \
	$(KERNEL) \
	$(KERNEL_ADDONS) \
	$(APPS) \
	$(LIBS)

#$(warning ALL = $(ALL))

